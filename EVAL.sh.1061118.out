SAVEPATH:  runs_evaluation/callhome_english.pt
Load Model...
From state-dict:  exp/callhome_english.pt
########################################
Load pretrained CPC
########################################
Froze EncoderCPC!
------------------------------------------------------------
Dataloader
  datasets: ['callhome_jpn']
  type: sliding
  sample_rate: 16000
  audio_mono: False
  audio_duration: 20
  audio_normalize: True
  audio_overlap: 2
  audio_context_duration: 5
  ipu_min_time: 1
  ipu_pause_time: 0.2
  vad_hz: 50
  vad_horizon: 2
  vad_history: True
  vad_history_times: [60, 30, 10, 5]
  batch_size: 4

Downloading and preparing dataset callhome/jpn to /home/z40351r/.cache/huggingface/datasets/callhome/jpn-6d5ac2c30a8cf9d8/0.0.0/bb383c2c33580aa1b3621e64db7adaf9e87030fda8bf79d0d0fc2005d6dc7758...
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 4 examples [00:00, 37.33 examples/s]Generating train split: 8 examples [00:00, 31.59 examples/s]Generating train split: 12 examples [00:00, 31.32 examples/s]Generating train split: 16 examples [00:00, 27.41 examples/s]Generating train split: 20 examples [00:00, 24.46 examples/s]Generating train split: 24 examples [00:00, 25.47 examples/s]Generating train split: 28 examples [00:01, 21.94 examples/s]Generating train split: 32 examples [00:01, 24.50 examples/s]Generating train split: 37 examples [00:01, 27.41 examples/s]Generating train split: 41 examples [00:01, 28.58 examples/s]Generating train split: 45 examples [00:01, 29.61 examples/s]Generating train split: 49 examples [00:01, 29.05 examples/s]Generating train split: 53 examples [00:01, 30.93 examples/s]Generating train split: 58 examples [00:02, 31.22 examples/s]Generating train split: 62 examples [00:02, 30.36 examples/s]Generating train split: 67 examples [00:02, 27.06 examples/s]Generating train split: 71 examples [00:02, 27.73 examples/s]Generating train split: 75 examples [00:02, 27.97 examples/s]Generating train split: 79 examples [00:02, 28.41 examples/s]Generating train split: 83 examples [00:02, 28.21 examples/s]                                                             Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 4 examples [00:00, 31.50 examples/s]Generating validation split: 8 examples [00:00, 30.40 examples/s]                                                                 Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 4 examples [00:00, 30.72 examples/s]Generating test split: 8 examples [00:00, 29.20 examples/s]                                                           Dataset callhome downloaded and prepared to /home/z40351r/.cache/huggingface/datasets/callhome/jpn-6d5ac2c30a8cf9d8/0.0.0/bb383c2c33580aa1b3621e64db7adaf9e87030fda8bf79d0d0fc2005d6dc7758. Subsequent calls will reuse this data.
Map:   0%|          | 0/83 [00:00<?, ? examples/s]                                                  Map:   0%|          | 0/11 [00:00<?, ? examples/s]                                                  Map:   0%|          | 0/10 [00:00<?, ? examples/s]                                                  GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/logger_connector.py:67: UserWarning: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `pytorch_lightning` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
  warning_cache.warn(
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 40 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[W socket.cpp:401] [c10d] The server socket cannot be initialized on [::]:36104 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:36104 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:36104 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing: 0it [00:00, ?it/s]
Phrases:   0%|          | 0/36 [00:00<?, ?it/s][A
Phrases:   3%|▎         | 1/36 [00:01<00:36,  1.05s/it][A
Phrases:  14%|█▍        | 5/36 [00:01<00:05,  5.44it/s][A
Phrases:  22%|██▏       | 8/36 [00:01<00:03,  8.82it/s][A
Phrases:  33%|███▎      | 12/36 [00:01<00:01, 13.58it/s][A
Phrases:  44%|████▍     | 16/36 [00:01<00:01, 18.20it/s][A
Phrases:  56%|█████▌    | 20/36 [00:01<00:00, 21.04it/s][A
Phrases:  67%|██████▋   | 24/36 [00:01<00:00, 24.69it/s][A
Phrases:  78%|███████▊  | 28/36 [00:01<00:00, 26.97it/s][A
Phrases:  89%|████████▉ | 32/36 [00:01<00:00, 29.92it/s][A
                                                        [ATesting:   0%|          | 0/75 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/75 [00:00<?, ?it/s]Testing DataLoader 0:   1%|▏         | 1/75 [00:00<00:31,  2.34it/s]Testing DataLoader 0:   3%|▎         | 2/75 [00:00<00:28,  2.59it/s]Testing DataLoader 0:   4%|▍         | 3/75 [00:01<00:26,  2.73it/s]Testing DataLoader 0:   5%|▌         | 4/75 [00:01<00:24,  2.96it/s]Testing DataLoader 0:   7%|▋         | 5/75 [00:01<00:26,  2.61it/s]Testing DataLoader 0:   8%|▊         | 6/75 [00:02<00:25,  2.72it/s]Testing DataLoader 0:   9%|▉         | 7/75 [00:02<00:23,  2.86it/s]Testing DataLoader 0:  11%|█         | 8/75 [00:02<00:22,  3.00it/s]Testing DataLoader 0:  12%|█▏        | 9/75 [00:02<00:20,  3.16it/s]Testing DataLoader 0:  13%|█▎        | 10/75 [00:03<00:19,  3.32it/s]Testing DataLoader 0:  15%|█▍        | 11/75 [00:03<00:18,  3.47it/s]Testing DataLoader 0:  16%|█▌        | 12/75 [00:03<00:17,  3.64it/s]Testing DataLoader 0:  17%|█▋        | 13/75 [00:03<00:16,  3.80it/s]Testing DataLoader 0:  19%|█▊        | 14/75 [00:03<00:15,  3.96it/s]Testing DataLoader 0:  20%|██        | 15/75 [00:03<00:14,  4.10it/s]Testing DataLoader 0:  21%|██▏       | 16/75 [00:03<00:13,  4.24it/s]Testing DataLoader 0:  23%|██▎       | 17/75 [00:03<00:13,  4.38it/s]Testing DataLoader 0:  24%|██▍       | 18/75 [00:03<00:12,  4.50it/s]Testing DataLoader 0:  25%|██▌       | 19/75 [00:04<00:12,  4.62it/s]Testing DataLoader 0:  27%|██▋       | 20/75 [00:04<00:11,  4.73it/s]Testing DataLoader 0:  28%|██▊       | 21/75 [00:04<00:11,  4.84it/s]Testing DataLoader 0:  29%|██▉       | 22/75 [00:04<00:10,  4.94it/s]Testing DataLoader 0:  31%|███       | 23/75 [00:04<00:10,  5.03it/s]Testing DataLoader 0:  32%|███▏      | 24/75 [00:04<00:09,  5.13it/s]Testing DataLoader 0:  33%|███▎      | 25/75 [00:04<00:09,  5.21it/s]Testing DataLoader 0:  35%|███▍      | 26/75 [00:04<00:09,  5.29it/s]Testing DataLoader 0:  36%|███▌      | 27/75 [00:05<00:08,  5.37it/s]Testing DataLoader 0:  37%|███▋      | 28/75 [00:05<00:08,  5.44it/s]Testing DataLoader 0:  39%|███▊      | 29/75 [00:05<00:08,  5.51it/s]Testing DataLoader 0:  40%|████      | 30/75 [00:05<00:08,  5.57it/s]Testing DataLoader 0:  41%|████▏     | 31/75 [00:05<00:07,  5.64it/s]Testing DataLoader 0:  43%|████▎     | 32/75 [00:05<00:07,  5.69it/s]Testing DataLoader 0:  44%|████▍     | 33/75 [00:05<00:07,  5.75it/s]Testing DataLoader 0:  45%|████▌     | 34/75 [00:05<00:07,  5.81it/s]Testing DataLoader 0:  47%|████▋     | 35/75 [00:05<00:06,  5.86it/s]Testing DataLoader 0:  48%|████▊     | 36/75 [00:06<00:06,  5.91it/s]Testing DataLoader 0:  49%|████▉     | 37/75 [00:06<00:06,  5.96it/s]Testing DataLoader 0:  51%|█████     | 38/75 [00:06<00:06,  6.01it/s]Testing DataLoader 0:  52%|█████▏    | 39/75 [00:06<00:05,  6.05it/s]Testing DataLoader 0:  53%|█████▎    | 40/75 [00:06<00:05,  6.09it/s]Testing DataLoader 0:  55%|█████▍    | 41/75 [00:06<00:05,  6.14it/s]Testing DataLoader 0:  56%|█████▌    | 42/75 [00:06<00:05,  6.18it/s]Testing DataLoader 0:  57%|█████▋    | 43/75 [00:06<00:05,  6.22it/s]Testing DataLoader 0:  59%|█████▊    | 44/75 [00:07<00:04,  6.26it/s]Testing DataLoader 0:  60%|██████    | 45/75 [00:07<00:04,  6.30it/s]Testing DataLoader 0:  61%|██████▏   | 46/75 [00:07<00:04,  6.34it/s]Testing DataLoader 0:  63%|██████▎   | 47/75 [00:07<00:04,  6.38it/s]Testing DataLoader 0:  64%|██████▍   | 48/75 [00:07<00:04,  6.41it/s]Testing DataLoader 0:  65%|██████▌   | 49/75 [00:07<00:04,  6.44it/s]Testing DataLoader 0:  67%|██████▋   | 50/75 [00:07<00:03,  6.48it/s]Testing DataLoader 0:  68%|██████▊   | 51/75 [00:07<00:03,  6.51it/s]Testing DataLoader 0:  69%|██████▉   | 52/75 [00:07<00:03,  6.54it/s]Testing DataLoader 0:  71%|███████   | 53/75 [00:08<00:03,  6.57it/s]Testing DataLoader 0:  72%|███████▏  | 54/75 [00:08<00:03,  6.60it/s]Testing DataLoader 0:  73%|███████▎  | 55/75 [00:08<00:03,  6.63it/s]Testing DataLoader 0:  75%|███████▍  | 56/75 [00:08<00:02,  6.65it/s]Testing DataLoader 0:  76%|███████▌  | 57/75 [00:08<00:02,  6.68it/s]Testing DataLoader 0:  77%|███████▋  | 58/75 [00:08<00:02,  6.71it/s]Testing DataLoader 0:  79%|███████▊  | 59/75 [00:08<00:02,  6.73it/s]Testing DataLoader 0:  80%|████████  | 60/75 [00:08<00:02,  6.76it/s]Testing DataLoader 0:  81%|████████▏ | 61/75 [00:08<00:02,  6.78it/s]Testing DataLoader 0:  83%|████████▎ | 62/75 [00:09<00:01,  6.80it/s]Testing DataLoader 0:  84%|████████▍ | 63/75 [00:09<00:01,  6.82it/s]Testing DataLoader 0:  85%|████████▌ | 64/75 [00:09<00:01,  6.84it/s]Testing DataLoader 0:  87%|████████▋ | 65/75 [00:09<00:01,  6.86it/s]Testing DataLoader 0:  88%|████████▊ | 66/75 [00:09<00:01,  6.89it/s]Testing DataLoader 0:  89%|████████▉ | 67/75 [00:09<00:01,  6.90it/s]Testing DataLoader 0:  91%|█████████ | 68/75 [00:09<00:01,  6.92it/s]Testing DataLoader 0:  92%|█████████▏| 69/75 [00:09<00:00,  6.94it/s]Testing DataLoader 0:  93%|█████████▎| 70/75 [00:10<00:00,  6.96it/s]Testing DataLoader 0:  95%|█████████▍| 71/75 [00:10<00:00,  6.98it/s]Testing DataLoader 0:  96%|█████████▌| 72/75 [00:10<00:00,  7.00it/s]Testing DataLoader 0:  97%|█████████▋| 73/75 [00:10<00:00,  7.01it/s]Testing DataLoader 0:  99%|█████████▊| 74/75 [00:10<00:00,  7.03it/s]Testing DataLoader 0: 100%|██████████| 75/75 [00:10<00:00,  7.08it/s]/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: The ``compute`` method of metric MulticlassF1Score was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: The ``compute`` method of metric MulticlassAccuracy was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
Testing DataLoader 0: 100%|██████████| 75/75 [00:10<00:00,  7.06it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric               DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       test_hs:f1w            0.6752554178237915
    test_hs:shift_acc         0.5512256622314453
  test_long_future_hold       0.3092629611492157
  test_long_future_pred       0.3959726393222809
  test_long_future_react      0.552006721496582
    test_long_now_hold       0.09006363898515701
    test_long_now_pred       0.17986024916172028
   test_long_now_react        0.5198251008987427
test_long_scp_future_hold     0.2982116937637329
test_long_scp_future_pred    0.34006449580192566
test_long_scp_future_react    0.3246373236179352
  test_long_scp_now_hold     0.08647313714027405
  test_long_scp_now_pred     0.10256453603506088
 test_long_scp_now_react     0.09941772371530533
  test_long_scp_tot_hold     0.19476397335529327
  test_long_scp_tot_pred     0.22474946081638336
 test_long_scp_tot_react      0.2149316817522049
    test_long_tot_hold        0.2023538202047348
    test_long_tot_pred        0.2930105924606323
   test_long_tot_react        0.5378299355506897
        test_loss             3.5474355220794678
       test_loss_va           0.3925212621688843
      test_ls:short           0.5471698045730591
   test_pred_bc:bc_pred              0.0
    test_pred_sh:shift       0.37037035822868347
  test_short_future_hold     0.29754024744033813
  test_short_future_pred      0.4211505353450775
 test_short_future_react      0.5646650791168213
   test_short_now_hold       0.08635171502828598
   test_short_now_pred       0.17626048624515533
   test_short_now_react       0.5203990936279297
   test_short_tot_hold       0.19437210261821747
   test_short_tot_pred        0.3050878345966339
   test_short_tot_react       0.5448440909385681
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
result_end
Saved to ->  runs_evaluation/callhome_english.pt/callhome_jpn_score.csv
