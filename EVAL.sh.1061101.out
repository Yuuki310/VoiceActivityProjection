GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/logger_connector.py:67: UserWarning: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `pytorch_lightning` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
  warning_cache.warn(
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 40 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[W socket.cpp:401] [c10d] The server socket cannot be initialized on [::]:57913 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:57913 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:57913 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SAVEPATH:  runs_evaluation/callhome_english.pt
Load Model...
From state-dict:  exp/callhome_english.pt
########################################
Load pretrained CPC
########################################
Froze EncoderCPC!
------------------------------------------------------------
Dataloader
  datasets: ['callhome_eng']
  type: sliding
  sample_rate: 16000
  audio_mono: False
  audio_duration: 20
  audio_normalize: True
  audio_overlap: 2
  audio_context_duration: 5
  ipu_min_time: 1
  ipu_pause_time: 0.2
  vad_hz: 50
  vad_horizon: 2
  vad_history: True
  vad_history_times: [60, 30, 10, 5]
  batch_size: 4

Testing: 0it [00:00, ?it/s]
Phrases:   0%|          | 0/36 [00:00<?, ?it/s][A
Phrases:   3%|▎         | 1/36 [00:04<02:53,  4.96s/it][A
Phrases:   8%|▊         | 3/36 [00:05<00:45,  1.37s/it][A
Phrases:  19%|█▉        | 7/36 [00:05<00:13,  2.16it/s][A
Phrases:  31%|███       | 11/36 [00:05<00:06,  3.99it/s][A
Phrases:  42%|████▏     | 15/36 [00:05<00:03,  6.26it/s][A
Phrases:  53%|█████▎    | 19/36 [00:05<00:01,  8.79it/s][A
Phrases:  61%|██████    | 22/36 [00:05<00:01, 10.63it/s][A
Phrases:  69%|██████▉   | 25/36 [00:05<00:00, 12.44it/s][A
Phrases:  78%|███████▊  | 28/36 [00:06<00:00, 14.95it/s][A
Phrases:  89%|████████▉ | 32/36 [00:06<00:00, 18.86it/s][A
Phrases: 100%|██████████| 36/36 [00:06<00:00, 22.89it/s][A
                                                        [ATesting:   0%|          | 0/93 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/93 [00:00<?, ?it/s]Testing DataLoader 0:   1%|          | 1/93 [00:00<00:46,  1.99it/s]Testing DataLoader 0:   2%|▏         | 2/93 [00:00<00:41,  2.18it/s]Testing DataLoader 0:   3%|▎         | 3/93 [00:01<00:39,  2.29it/s]Testing DataLoader 0:   4%|▍         | 4/93 [00:01<00:35,  2.52it/s]Testing DataLoader 0:   5%|▌         | 5/93 [00:01<00:34,  2.58it/s]Testing DataLoader 0:   6%|▋         | 6/93 [00:02<00:31,  2.73it/s]Testing DataLoader 0:   8%|▊         | 7/93 [00:02<00:31,  2.75it/s]Testing DataLoader 0:   9%|▊         | 8/93 [00:02<00:29,  2.85it/s]Testing DataLoader 0:  10%|▉         | 9/93 [00:03<00:28,  2.94it/s]Testing DataLoader 0:  11%|█         | 10/93 [00:03<00:27,  3.04it/s]Testing DataLoader 0:  12%|█▏        | 11/93 [00:03<00:26,  3.11it/s]Testing DataLoader 0:  13%|█▎        | 12/93 [00:03<00:24,  3.24it/s]Testing DataLoader 0:  14%|█▍        | 13/93 [00:03<00:23,  3.34it/s]Testing DataLoader 0:  15%|█▌        | 14/93 [00:04<00:22,  3.48it/s]Testing DataLoader 0:  16%|█▌        | 15/93 [00:04<00:21,  3.62it/s]Testing DataLoader 0:  17%|█▋        | 16/93 [00:04<00:20,  3.75it/s]Testing DataLoader 0:  18%|█▊        | 17/93 [00:04<00:19,  3.88it/s]Testing DataLoader 0:  19%|█▉        | 18/93 [00:04<00:18,  4.00it/s]Testing DataLoader 0:  20%|██        | 19/93 [00:04<00:17,  4.12it/s]Testing DataLoader 0:  22%|██▏       | 20/93 [00:04<00:17,  4.23it/s]Testing DataLoader 0:  23%|██▎       | 21/93 [00:04<00:16,  4.34it/s]Testing DataLoader 0:  24%|██▎       | 22/93 [00:04<00:15,  4.44it/s]Testing DataLoader 0:  25%|██▍       | 23/93 [00:05<00:15,  4.54it/s]Testing DataLoader 0:  26%|██▌       | 24/93 [00:05<00:14,  4.64it/s]Testing DataLoader 0:  27%|██▋       | 25/93 [00:05<00:14,  4.73it/s]Testing DataLoader 0:  28%|██▊       | 26/93 [00:05<00:13,  4.81it/s]Testing DataLoader 0:  29%|██▉       | 27/93 [00:05<00:13,  4.89it/s]Testing DataLoader 0:  30%|███       | 28/93 [00:05<00:13,  4.97it/s]Testing DataLoader 0:  31%|███       | 29/93 [00:05<00:12,  5.05it/s]Testing DataLoader 0:  32%|███▏      | 30/93 [00:05<00:12,  5.13it/s]Testing DataLoader 0:  33%|███▎      | 31/93 [00:05<00:11,  5.20it/s]Testing DataLoader 0:  34%|███▍      | 32/93 [00:06<00:11,  5.27it/s]Testing DataLoader 0:  35%|███▌      | 33/93 [00:06<00:11,  5.33it/s]Testing DataLoader 0:  37%|███▋      | 34/93 [00:06<00:10,  5.39it/s]Testing DataLoader 0:  38%|███▊      | 35/93 [00:06<00:10,  5.45it/s]Testing DataLoader 0:  39%|███▊      | 36/93 [00:06<00:10,  5.50it/s]Testing DataLoader 0:  40%|███▉      | 37/93 [00:06<00:10,  5.56it/s]Testing DataLoader 0:  41%|████      | 38/93 [00:06<00:09,  5.62it/s]Testing DataLoader 0:  42%|████▏     | 39/93 [00:06<00:09,  5.68it/s]Testing DataLoader 0:  43%|████▎     | 40/93 [00:06<00:09,  5.74it/s]Testing DataLoader 0:  44%|████▍     | 41/93 [00:07<00:08,  5.79it/s]Testing DataLoader 0:  45%|████▌     | 42/93 [00:07<00:08,  5.83it/s]Testing DataLoader 0:  46%|████▌     | 43/93 [00:07<00:08,  5.88it/s]Testing DataLoader 0:  47%|████▋     | 44/93 [00:07<00:08,  5.92it/s]Testing DataLoader 0:  48%|████▊     | 45/93 [00:07<00:08,  5.96it/s]Testing DataLoader 0:  49%|████▉     | 46/93 [00:07<00:07,  6.00it/s]Testing DataLoader 0:  51%|█████     | 47/93 [00:07<00:07,  6.04it/s]Testing DataLoader 0:  52%|█████▏    | 48/93 [00:07<00:07,  6.08it/s]Testing DataLoader 0:  53%|█████▎    | 49/93 [00:08<00:07,  6.11it/s]Testing DataLoader 0:  54%|█████▍    | 50/93 [00:08<00:06,  6.15it/s]Testing DataLoader 0:  55%|█████▍    | 51/93 [00:08<00:06,  6.18it/s]Testing DataLoader 0:  56%|█████▌    | 52/93 [00:08<00:06,  6.21it/s]Testing DataLoader 0:  57%|█████▋    | 53/93 [00:08<00:06,  6.24it/s]Testing DataLoader 0:  58%|█████▊    | 54/93 [00:08<00:06,  6.27it/s]Testing DataLoader 0:  59%|█████▉    | 55/93 [00:08<00:06,  6.30it/s]Testing DataLoader 0:  60%|██████    | 56/93 [00:08<00:05,  6.33it/s]Testing DataLoader 0:  61%|██████▏   | 57/93 [00:08<00:05,  6.36it/s]Testing DataLoader 0:  62%|██████▏   | 58/93 [00:09<00:05,  6.39it/s]Testing DataLoader 0:  63%|██████▎   | 59/93 [00:09<00:05,  6.42it/s]Testing DataLoader 0:  65%|██████▍   | 60/93 [00:09<00:05,  6.44it/s]Testing DataLoader 0:  66%|██████▌   | 61/93 [00:09<00:04,  6.47it/s]Testing DataLoader 0:  67%|██████▋   | 62/93 [00:09<00:04,  6.50it/s]Testing DataLoader 0:  68%|██████▊   | 63/93 [00:09<00:04,  6.52it/s]Testing DataLoader 0:  69%|██████▉   | 64/93 [00:09<00:04,  6.54it/s]Testing DataLoader 0:  70%|██████▉   | 65/93 [00:09<00:04,  6.56it/s]Testing DataLoader 0:  71%|███████   | 66/93 [00:10<00:04,  6.59it/s]Testing DataLoader 0:  72%|███████▏  | 67/93 [00:10<00:03,  6.61it/s]Testing DataLoader 0:  73%|███████▎  | 68/93 [00:10<00:03,  6.63it/s]Testing DataLoader 0:  74%|███████▍  | 69/93 [00:10<00:03,  6.65it/s]Testing DataLoader 0:  75%|███████▌  | 70/93 [00:10<00:03,  6.67it/s]Testing DataLoader 0:  76%|███████▋  | 71/93 [00:10<00:03,  6.69it/s]Testing DataLoader 0:  77%|███████▋  | 72/93 [00:10<00:03,  6.71it/s]Testing DataLoader 0:  78%|███████▊  | 73/93 [00:10<00:02,  6.73it/s]Testing DataLoader 0:  80%|███████▉  | 74/93 [00:10<00:02,  6.75it/s]Testing DataLoader 0:  81%|████████  | 75/93 [00:11<00:02,  6.77it/s]Testing DataLoader 0:  82%|████████▏ | 76/93 [00:11<00:02,  6.78it/s]Testing DataLoader 0:  83%|████████▎ | 77/93 [00:11<00:02,  6.80it/s]Testing DataLoader 0:  84%|████████▍ | 78/93 [00:11<00:02,  6.82it/s]Testing DataLoader 0:  85%|████████▍ | 79/93 [00:11<00:02,  6.84it/s]Testing DataLoader 0:  86%|████████▌ | 80/93 [00:11<00:01,  6.86it/s]Testing DataLoader 0:  87%|████████▋ | 81/93 [00:11<00:01,  6.87it/s]Testing DataLoader 0:  88%|████████▊ | 82/93 [00:11<00:01,  6.89it/s]Testing DataLoader 0:  89%|████████▉ | 83/93 [00:12<00:01,  6.90it/s]Testing DataLoader 0:  90%|█████████ | 84/93 [00:12<00:01,  6.92it/s]Testing DataLoader 0:  91%|█████████▏| 85/93 [00:12<00:01,  6.93it/s]Testing DataLoader 0:  92%|█████████▏| 86/93 [00:12<00:01,  6.95it/s]Testing DataLoader 0:  94%|█████████▎| 87/93 [00:12<00:00,  6.97it/s]Testing DataLoader 0:  95%|█████████▍| 88/93 [00:12<00:00,  6.98it/s]Testing DataLoader 0:  96%|█████████▌| 89/93 [00:12<00:00,  6.99it/s]Testing DataLoader 0:  97%|█████████▋| 90/93 [00:12<00:00,  7.01it/s]Testing DataLoader 0:  98%|█████████▊| 91/93 [00:12<00:00,  7.02it/s]Testing DataLoader 0:  99%|█████████▉| 92/93 [00:13<00:00,  6.99it/s]Testing DataLoader 0: 100%|██████████| 93/93 [00:13<00:00,  7.00it/s]/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: The ``compute`` method of metric MulticlassF1Score was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
/home/z40351r/anaconda3/envs/vap2/lib/python3.9/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: The ``compute`` method of metric MulticlassAccuracy was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
Testing DataLoader 0: 100%|██████████| 93/93 [00:13<00:00,  6.96it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric               DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       test_hs:f1w            0.6824117302894592
    test_hs:shift_acc         0.6140027642250061
  test_long_future_hold       0.3092629611492157
  test_long_future_pred       0.3959726393222809
  test_long_future_react      0.552006721496582
    test_long_now_hold       0.09006363898515701
    test_long_now_pred       0.17986024916172028
   test_long_now_react        0.5198251008987427
test_long_scp_future_hold     0.2982116937637329
test_long_scp_future_pred    0.34006449580192566
test_long_scp_future_react    0.3246373236179352
  test_long_scp_now_hold     0.08647313714027405
  test_long_scp_now_pred     0.10256453603506088
 test_long_scp_now_react     0.09941772371530533
  test_long_scp_tot_hold     0.19476397335529327
  test_long_scp_tot_pred     0.22474946081638336
 test_long_scp_tot_react      0.2149316817522049
    test_long_tot_hold        0.2023538202047348
    test_long_tot_pred        0.2930105924606323
   test_long_tot_react        0.5378299355506897
        test_loss             2.4956862926483154
       test_loss_va           0.2429327368736267
      test_ls:short           0.6722891330718994
   test_pred_bc:bc_pred              0.0
    test_pred_sh:shift       0.36747968196868896
  test_short_future_hold     0.29754024744033813
  test_short_future_pred      0.4211505353450775
 test_short_future_react      0.5646650791168213
   test_short_now_hold       0.08635171502828598
   test_short_now_pred       0.17626048624515533
   test_short_now_react       0.5203990936279297
   test_short_tot_hold       0.19437210261821747
   test_short_tot_pred        0.3050878345966339
   test_short_tot_react       0.5448440909385681
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
result_end
Saved to ->  runs_evaluation/callhome_english.pt/score.csv
